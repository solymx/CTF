# Hitcon CTF 2016 Quals - Notes

## Hackpad

給了一個 pcap 檔案，大概看了一下

之後用 ```strings a.pcap | less```

可以大概看到類似
```
msg=00000000000000000000000000000002997d9369c74c82abba4cc3b1bfc65f02
HTTP/1.1 500 Internal Server Error

msg=00000000000000000000000000000003997d9369c74c82abba4cc3b1bfc65f02
HTTP/1.1 500 Internal Server Error

msg=00000000000000000000000000000004997d9369c74c82abba4cc3b1bfc65f02
HTTP/1.1 500 Internal Server Error
...
...
msg=00000000000000000000000000000000997d9369c74c82abba4cc3b1bfc65f02
HTTP/1.1 200 OK

```
可以看到他是一個一個 byte 去嘗試是 500 或 200 ok 

可以猜測是考 padding oracle attack 

先記一下
```
msg=
3ed2e01c1d1248125c67ac637384a22d : C0
997d9369c74c82abba4cc3b1bfc65f02 : C1
6c957ff0feef61b161cfe3373c2d9b90 : C2
5639aa3688659566d9acc93bb72080f7 : C3
e5ebd643808a0e50e1fc3d16246afcf6 : C4
88dfedf02ad4ae84fd92c5c53bbd98f0 : C5
8b21d838a3261874c4ee3ce8fbcb9662 : C6
8d5706499dd985ec0c13573eeee03766 : C7
f7010a867edfed92c33233b17a9730eb : C8
4a82a6db51fa6124bfc48ef99d669e21 : C9
740d12656f597e691bbcbaa67abe1a09 : C10
f02afc37140b167533c7536ab2ecd4ed : C11
37572fc9154d23aa7d8c92b84b774702 : C12
632ed2737a569e4dfbe01338fcbb2a77 : C13
ddd6990ce169bb4f48e1ca96d30eced2 : C14
3b6fe5b875ca6481056848be0fbc26bc : C15
bffdfe966da4221103408f459ec1ef12 : C16
c72068bc1b96df045d3fa12cc2a9dcd1 : C17
62ffdf876b3bc3a3ed2373559bcbe3f4 : C18
70a8c695bf54796bfe471cd34b463e98 : C19
76212df912deef882b657954d7dada47 : C20
```

cbc 加密是 
C0 = E(P0 ^ IV)
C1 = E(C1 ^ P1)

解密是
P0 = D(C0) ^ IV
P1 = D(C1) ^ C0
P2 = D(C2) ^ C1

那以 C1 舉例，直接 ```strings a.pcap | grep '997d9369c74c82abba4cc3b1bfc65f02'```

可以看到最後一個是
```
msg=67acd06f7f7b28762310ce1213fccb11997d9369c74c82abba4cc3b1bfc65f02
```

其中前半段就是 D(C1)

所以如果我們用 ```0x67acd06f7f7b28762310ce1213fccb11 ^ 3ed2e01c1d1248125c67ac637384a22d```

可以得到 ```In cryptography,```

以此類推，可以得到全部的明文

整理一下
```python

c0 = '3ed2e01c1d1248125c67ac637384a22d' 
c1= '67acd06f7f7b28762310ce1213fccb11997d9369c74c82abba4cc3b1bfc65f02' # D(C1):C1
c2= 'a90ca309b638f6d2c43bf3ceddb72c7e6c957ff0feef61b161cfe3373c2d9b90' # D(C2):C2
c3= '19a50e949a9e12ca51b680074d53abe15639aa3688659566d9acc93bb72080f7' # D(C3):C3
c4= '325ddb45f355f21ea0dfb10bce43b097e5ebd643808a0e50e1fc3d16246afcf6'
c5= '9089a03ce2f77b24d1995e6f5a1dcc9288dfedf02ad4ae84fd92c5c53bbd98f0'   
c6= 'f0aadd905ba0dafd83e5f5ba4d8de9c08b21d838a3261874c4ee3ce8fbcb9662'   
c7= 'f843b158c7596f16b58e449188fbeb178d5706499dd985ec0c13573eeee03766'   
c8= 'ee34773ee8e79f9475772441908b6f42f7010a867edfed92c33233b17a9730eb'   
c9= '847a7ff24ead84a2b20247c45bee43924a82a6db51fa6124bfc48ef99d669e21'   
c10= '6ae7c5eb319f1550c6baf9c9aa45a94c740d12656f597e691bbcbaa67abe1a09'
c11= '6e546c551c3b17097fc3cdc40bde6260f02afc37140b167533c7536ab2ecd4ed'
c12= 'cc1a9a46767267074fb26e16c792a38937572fc9154d23aa7d8c92b84b774702'
c13= '4f674fb564345dce08e4f68836022461632ed2737a569e4dfbe01338fcbb2a77'
c14= '1259a7104a29e8298e9e23408ddd5f47ddd6990ce169bb4f48e1ca96d30eced2'
c15= 'b9a9a97e9459db3e3c95bfe2e336bbba3b6fe5b875ca6481056848be0fbc26bc'
c16= '5b1e9bcc00be5db1611778cc7a8c55c3bffdfe966da4221103408f459ec1ef12'
c17= 'c29d8ff214d65e643327f621e6f18b6ac72068bc1b96df045d3fa12cc2a9dcd1'
c18= 'b2100dc26fe3bd783446df5bf2dabeb862ffdf876b3bc3a3ed2373559bcbe3f4'
c19= '029ba0f0094aa3db94504335f9b29e8d70a8c695bf54796bfe471cd34b463e98'
c20= '14d1a0e0814e6371e45d06c9515c248276212df912deef882b657954d7dada47'
```


https://bamboofox.github.io/write-ups/2016/10/14/HITCON-CTF-2016-Quals-Hackpad-150.html