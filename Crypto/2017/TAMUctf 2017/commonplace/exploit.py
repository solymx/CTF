#!/usr/bin/env python
import libnum
import gmpy2
def common_modulus_attack(c1, c2, e1, e2, n):
    _ , s1, s2 = gmpy2.gcdext(e1, e2)
    if s1 < 0:
        s1 = -s1
        c1 = gmpy2.invert(c1, n)
    elif s2 < 0:
        s2 = -s2
        c2 = gmpy2.invert(c2, n)
    c1s1 = pow(c1, s1, n)
    c2s2 = pow(c2, s2, n)
    m = (c1s1 * c2s2) % n
    return m
c1= 113813183669138175934253327749893332943694663202917548419879979936113727807991975380789093990918555434528794103836763855754041437680205960804923000204634278886935954216863968768728071369713538578259340141128572389122463301812462867702677705382960446527304300249850434659234034059007093429421932891935128492191

c2= 59592662056482906433736561597578166591998193181333493694719960644468628650001544958506724082784316619123428485133794736006814756155380574695012682374575344544660341665720360568288716218348833128874115263588724816642658565570037107367937645463033170935908829842437861807209356311867606830691669626376334399022

e1= 65537

e2= 65539

N= 140216241479851920702913185519800783649753498440837063273589417093260541429672666580261240688082289292539743280956921925064315299379164225490594370970136829532546393944568725668725847968007488489962801409779037532011361897601886281985696292232495507470403707038858415259380311715703788874074076955567300548823

m = common_modulus_attack(c1,c2,e1,e2,N)
print libnum.n2s(m)
