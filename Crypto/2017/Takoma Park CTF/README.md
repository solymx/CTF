# Takoma Park CTF - Notes

## 768

n 只有 768 bits ，丟 factordb.com 可以直接得到 p & q

```python
from Crypto.Util.number import long_to_bytes
import gmpy2

n=0xCAD984557C97E039431A226AD727F0C6D43EF3D418469F1B375049B229843EE9F83B1F97738AC274F5F61F401F21F1913E4B64BB31B55A38D398C0DFED00B1392F0889711C44B359E7976C617FCC734F06E3E95C26476091B52F462E79413DB5 
e=0x10001 
c=0x3F808414886E7C91F1D78AEB7EF920D2C9294AC384DCBB1A48032E8CAB79131AB3C1852896EEEECB5BA055AE77BBB619741FDE4D01AAC7D56F4E44508A8FC81A86DDB929A112AA80C4A7221B3C651E14E2D701B52E295152813CD9EFB4B51CB

p = 33478071698956898786044169848212690817704794983713768568912431388982883793878002287614711652531743087737814467999489

q = 36746043666799590428244633799627952632279158164343087642676032283815739666511279233373417143396810270092798736308917

phi = (p-1)*(q-1)
d = int(gmpy2.invert(e, phi))
m = pow(c, d, n)
print(long_to_bytes(m))
```

## Public key? What about <i>no</i> key?
> hint: ASCII
> 題目: c=15012609384250219874677875435291183380996259887801084362959689829793222820134760849765791998362570297144822180464823226497176797573924507385893298639389936970609654009208449211712524653396481688098765049753795004757286133915930065553473346650316038234942894495434455505706415219264874108132945199942497009318662312261285017458955601407708432421306656177311165962626469501149556920141649893075576065182442722565993670091384298304208560718934089830554216153181578651271817639734178379386792901071212521730951208634247651506838688837039218543506015273510119988575723357218697432626850682052021919641749097620521669376865644271405225686919943046358746932323787615218639765186753354460963203088883514851667268021038592274551957739329067941888


先講結論，爛題目 / 猜謎


首先他只有給 c ，這種在 rsa 裡面可以先猜他是 `pow(m, e) < n` ，故 m = c 開 e 次方根

```
import gmpy2

c=15012609384250219874677875435291183380996259887801084362959689829793222820134760849765791998362570297144822180464823226497176797573924507385893298639389936970609654009208449211712524653396481688098765049753795004757286133915930065553473346650316038234942894495434455505706415219264874108132945199942497009318662312261285017458955601407708432421306656177311165962626469501149556920141649893075576065182442722565993670091384298304208560718934089830554216153181578651271817639734178379386792901071212521730951208634247651506838688837039218543506015273510119988575723357218697432626850682052021919641749097620521669376865644271405225686919943046358746932323787615218639765186753354460963203088883514851667268021038592274551957739329067941888

for i in range(2, 1000):
	if gmpy2.iroot(c, i)[1]:
		print(i)
		print("m = ", gmpy2.iroot(c, i)[0])
		break
```

這樣可以知道要開 17 方根，也就是 e = 17

然後得到明文 m = 20160320062715081415090715200318010311050428

但你把她轉文字會發現亂碼，根據提示 ascii

需要把她拆開看，且我們知道答案格式固定: tpctf{...}

```
t  p  c  t  f  {                                               }
20 16 03 20 06 27 15 08 14 15 09 07 15 20 03 18 01 03 11 05 04 28
```

所以可以解密


```
m = [20,16,3,20,6,27,15,8,14,15,9,7,15,20,3,18,1,3,11,5,4,28]
ans = ''
for i in m:
	if i == 27:
		ans += '{'
	elif i == 28:
		ans += '}'
	else:
		ans += chr(i + 96)
print(ans)
```










