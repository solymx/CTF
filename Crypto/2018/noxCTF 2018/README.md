# noxCTF 2018 - Notes


## Chop Suey
給了 p, q, dp, dq, c

直接照個公式走的題目
```python
import libnum

p = 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229 
q = 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469 
dp = 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929 
dq = 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041 
c = 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852

qinv = libnum.invmod(q,p)
m1 = pow(c,dp,p)
m2 = pow(c,dq,q)
h = (m1-m2)*qinv % p 
m = m2 + h*q
print libnum.n2s(m)
```

## Decryptor
> Description:
>
> I created this nice decryptor for RSA ciphertexts, you should try it out!
> 
> nc chal.noxale.com 4242
> 
> Oh, and someone told me to give this to you: N = 140165355674296399459239442258630641339281917770736077969396713192714338090714726890918178888723629353043167144351074222216025145349467583141291274172356560132771690830020353668100494447956043734613525952945037667879068512918232837185005693504551982611886445611514773529698595162274883360353962852882911457919 c = 86445915530920147553767348020686132564453377048106098831426077547738998373682256014690928256854752252580894971618956714013602556152722531577337080534714463052378206442086672725486411296963581166836329721403101091377505869510101752378162287172126836920825099014089297075416142603776647872962582390687281063434 e = 65537


這題考單純的 Classic RSA Chosen Cipher Attack

他給了一個系統可以解任何密文，只是不可以幫我們解 flag 的密文

直接參照[ctf wiki](https://wiki.x10sec.org/crypto/asymmetric/rsa/rsa_chosen_cipher/) 走就可以了


```python
#!/usr/bin/env python
import libnum

n = 140165355674296399459239442258630641339281917770736077969396713192714338090714726890918178888723629353043167144351074222216025145349467583141291274172356560132771690830020353668100494447956043734613525952945037667879068512918232837185005693504551982611886445611514773529698595162274883360353962852882911457919 
c = 86445915530920147553767348020686132564453377048106098831426077547738998373682256014690928256854752252580894971618956714013602556152722531577337080534714463052378206442086672725486411296963581166836329721403101091377505869510101752378162287172126836920825099014089297075416142603776647872962582390687281063434 
e = 65537

x = 3 ## libnum.gcd(n,x)a == 1
y = (pow(x,e,n) * c) % n
mm = 0x14b4e68c9fcd371915fa65a479d56a59a2d77 # send server get this 
m = (mm*libnum.invmod(x,n)) % n
print libnum.n2s(m)
```

## Plot Twist
> Description:
>
> Can you get the flag from the flawlessly written server?
> 
> nc chal.noxale.com 5115

考 Classic Mersenne twister Prediction

可以看到這題是要我們猜到 key ，而 key 的產生方式是用 python2 的 random 這個 library

而這個 random library 內部是使用 `Mersenne Twister` ，這是一個不安全的虛擬亂數產生器





  
