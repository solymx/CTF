# EasyCTF IV 2018 - Notes


## RSA Returns

直接參考[這篇](https://ctftime.org/writeup/8805)

算是一個紀錄而已，畢竟自己也不會0.0


題目沒給什麼提示，考的是 ROCA ，差不多是 2017/10中到 11 月初的RSA 洞

詳細可以[參考](https://crocs.fi.muni.cz/public/papers/rsa_ccs17)


官方有提供工具可以檢測，[官方github](https://github.com/crocs-muni/roca)

當初自己有讀過這篇，不過都沒找到攻擊工具@@，剛好這篇write up 有提到

[neca](https://gitlab.com/jix/neca)


## RSA_v
> Description:
>
> Bob is extremely paranoid, so he decided that just one RSA encryption is not enough. Before sending his message to Alice, he forced her to create 5 public keys so he could encrypt his message 5 times! Show him that he still is not secure... 

我們可以看到 n 相同但 e 都不同

然後 rsa 加密: c = m^e (mod n)

所以這題可以寫成 c = m^(e1e2e3e4e5) (mod n)

e 算出來會很大，相對 d 會很小，可以試試看 wiener attack

```python
import RSAwienerHacker
import libnum
n = 9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469
e = 27587468384672288862881213094354358587433516035212531881921186101712498639965289973292625430363076074737388345935775494312333025500409503290686394032069
c = 7117565509436551004326380884878672285722722211683863300406979545670706419248965442464045826652880670654603049188012705474321735863639519103720255725251120

d =  RSAwienerHacker.hack_RSA(e,n)
print libnum.n2s(pow(c,d,n))

```

## Hidden Key


這題很有趣，給了我們 n, e, c, 2d+phi

[參考](https://ctftime.org/task/5361)


把 C^(2d+phi) mod n 展開可以得到

C^2d(mod n) * C^phi(mod n) 

=> M^2(mod n) * 1 


C^phi(mod n) 會等於 1 用到費瑪定理

也就是如果 gcd(a,p) = 1 and p is prime 則

a^phi(p) mod p = 1

```python 
import libnum 

n = 26520361246721655719312292942299590997777406526676863843012099874597354135915059455042239376324387799865053683242414636060009865587583173045275105457073082968243533504387905119043247388529642262414438526116242340640646581052259140730856602869915716683075789898757359771098724847778465228984815596078931371664087053561549606914105075834487920908928691828802759345002239892841824320364955010193182040747111546094295252827762503139260982913152531075677337995125360354293156865458241440186309803882568716210602936866629058410889597625550416294217700072058777542777083497633525029159889586234144102169842680272161183745721

e = 65537

c = 7418057243095790130042687065779702583554288701684857484514194801172294222458626819803912260156980577116251379730360494595360787198176052366623880562576447483406219805426610686644675038623537403087409914772622449653592895702054870869175670435789095639112627664236615046540518795677000409954873160628316626272163567705830245764662598626052114608721632793989844962828953647706639614802279473020211192036611008393324264343853025429310141786756433031256006580696886806558123345474279809833474067840131549259039990436737446672931220529391217431088545326280625895692744865166426041282243083293457565493214530087442183221292

d2_phi = 45614762360410229300212698129832564750331302865657508323173977053637449841505611287528058184192348840566221315228568671446549156638679494257938961387272062063098949100738786162532797890920043101547869966269453672948648924362631904429625232239887534242738487644500448074790752720083799014401870217385681081039018262858805431651444719629084023758324666731580812040390477922196960548253698139132501827455548068644079880155486688825629841080221071744769415881019858426562758569708023957635165912129811734183443537045716249795296152683405537442868538321416720588711975920577513834780887193070997464962139948390468804712622

print libnum.n2s(libnum.nroot(pow(c,d2,n),2))

```